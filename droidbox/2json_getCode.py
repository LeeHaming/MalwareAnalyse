#coding:'utf-8'
import json
import collections
import os

def dict_slice(dict,start,end):
	key=list(dict.keys())
	dict_slice={}
	for k in key[start:end]:
		dict_slice[k]=dict[k]
	return dict_slice

jsonlist=['recvnet','servicestart','sendsms','cryptousage','sendnet','accessedfiles','fdaccess','dataleaks','opennet','recvsaction','dexclass','closenet','phonecalls']
print(len(jsonlist))
#generate Code for every file
path="H:\MalwareAnalyze\droidbox\desNew\\"
files=os.listdir(path)
fpCode=open("DroidBoxCode.txt","w")

for file in files:
	#print(file)
	if not os.path.isdir(file):
		if (file.split('.')[0]).endswith('new')  and os.path.getsize(path+file):
			print(file)
			with open(path+file,'r') as load_f:
				load_dict = json.load(load_f)
				sequence=[]
			    
				#print(load_dict.keys())
				#print(len(load_dict))

				#for (k,v) in dict_slice(load_dict,3,16).items():
				for element in jsonlist:
					if(len(load_dict[element])>0):
						sequence.append(1)	
						#print(k)
					else:
						sequence.append(0)
				#print(str(sequence)+'\n')
			
			#fp=open(file,"a")

			fpCode.write(file)
			for seq in sequence:
				fpCode.write('\t'+str(seq))
			fpCode.write('\n')
			#fp.close()
fpCode.close()

